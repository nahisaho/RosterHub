# RosterHub - プロダクトコンテキスト

## ドキュメント概要

**プロジェクト**: RosterHub - OneRoster Japan Profile 1.2.2 統合ハブ
**バージョン**: 1.0
**最終更新**: 2025-11-15
**目的**: ビジネスコンテキスト、製品目的、対象ユーザー、ドメイン知識を文書化

---

## 1. プロダクト概要

### 1.1 プロダクト名

**RosterHub** - OneRoster Japan Profile 1.2.2 統合ハブ

### 1.2 プロダクトビジョン

**OneRoster国際標準と日本固有の拡張機能により、日本の教育機関と学習プラットフォーム間でのシームレスな名簿データ交換を実現する。**

### 1.3 エレベーターピッチ

RosterHubは、**OneRoster v1.2 Japan Profile 1.2.2 標準**を実装することで、日本の校務支援システムと学習eポータル間を橋渡しする統合ハブです。名簿データの同期を自動化し、手作業によるデータ入力を不要にし、日本の学校・大学における年度末の管理負担を軽減します。

---

## 2. ビジネスコンテキスト

### 2.1 課題の定義

#### 日本の教育現場における現状の課題

**1. 手作業による名簿データ入力の負担**
- 毎年度初め（日本では4月）に、管理者は複数の学習システムに生徒・教員名簿を手作業で入力しなければならない
- 平均的な日本の小学校では、5〜10の学習プラットフォームへの名簿データ入力に20〜40時間を費やす
- 高校や大学は、コース履修登録やクラス割り当てのため、さらに複雑な作業を強いられる

**2. 標準化の不在**
- 校務支援システムと学習系システム間での名簿データ交換の統一フォーマットが存在しない
- 各ベンダーが独自形式を使用し、ベンダーロックインを引き起こしている
- プラットフォーム切り替え時のデータ移行コストが高額

**3. 日本の教育システム固有の概念が未サポート**
- 国際標準では、日本の以下の概念がネイティブにサポートされていない:
  - **学年・組構造**: 日本の学校は学年（学年）とクラス（組）で生徒を組織化
  - **ホームルーム概念**: 生徒は1年間を通じてホームルーム（ホームルーム）に所属
  - **出席番号**: 各生徒はクラス内で出席番号（出席番号）を持つ
  - **名前表記**: 日本の名前は漢字・ひらがな・カタカナの表記が必要
  - **学校年度**: 日本の学年度は4月〜3月（9月〜6月ではない）

**4. データ同期の課題**
- 生徒の転入・転出には、システム全体での即座の名簿更新が必要
- 年度末のクラス替えには、調整された更新が必要
- 教員の配置が年度途中で変更されるが、システムに反映されない

### 2.2 解決アプローチ

RosterHubはこれらの問題を以下の方法で解決します:

**1. 日本向け拡張を備えた国際標準の実装**
- OneRoster v1.2 仕様（国際標準）に完全準拠
- 日本固有要件のためのJapan Profile 1.2.2 拡張をサポート
- ベースのOneRoster v1.2との後方互換性を維持

**2. 名簿データ交換の自動化**
- 校務支援システムが名簿データを一度エクスポート
- RosterHubが接続されたすべての学習プラットフォームに自動配信
- REST API経由のリアルタイム同期
- CSVインポート/エクスポート経由の一括同期

**3. 柔軟な統合の提供**
- リアルタイム統合用のREST API
- バッチ統合用のCSV一括データ形式
- 大規模データセット（20万人以上の生徒・教員）のストリーミングサポート
- 選択的データ同期のためのフィルタークエリ

---

## 3. 市場とドメイン

### 3.1 対象市場

**主要市場**: 日本（初期フォーカス）
- 小学校: 約19,000校、約630万人の児童
- 中学校: 約10,000校、約320万人の生徒
- 高等学校: 約4,800校、約310万人の生徒
- 大学: 約800機関、約290万人の学生

**将来市場**: 類似の教育構造を持つ他のアジア諸国

### 3.2 対象ユーザー

#### 主要ユーザー（直接ユーザー）

**1. 学校IT管理者（情報システム担当者）**
- **役割**: 校務支援システムと学習プラットフォーム統合の管理
- **目標**:
  - 手作業によるデータ入力作業の軽減
  - システム間での名簿データの正確性確保
  - 年度末名簿更新の簡素化
- **課題**:
  - 毎年名簿データ入力に何日も費やす
  - システム間のデータ不整合に対処
  - 緊急の生徒転入・転出更新への対応
- **使用方法**: RosterHub設定、APIキー管理、データ同期監視

**2. 校務担当教員**
- **役割**: 校務支援システムでの生徒・教員情報更新
- **目標**:
  - 名簿変更が学習プラットフォームに自動的に反映される
  - 重複データ入力の削減
- **課題**:
  - 複数のシステムで同じ情報を更新する必要
  - データ入力エラーのリスク
- **使用方法**: 自動同期の間接的な恩恵を受ける

#### 二次ユーザー（ステークホルダー）

**3. 教員**
- **役割**: 学習プラットフォームを教育に使用
- **目標**:
  - 学習プラットフォームで最新のクラス名簿にアクセス
  - 正確な生徒名とクラス割り当てを確認
- **メリット**:
  - 名簿更新を待つ必要がない
  - 常に正確な生徒情報が利用可能

**4. 児童・生徒・学生**
- **役割**: 学習プラットフォームへのアクセス
- **目標**:
  - 正しいアカウントで学習プラットフォームにログイン
  - 正確なクラス割り当てを確認
- **メリット**:
  - アカウントの自動プロビジョニング
  - 正確なコース履修登録

#### 技術ユーザー（開発者）

**5. システムインテグレーター**
- **役割**: 校務支援システムと学習プラットフォームをRosterHubと統合
- **目標**:
  - OneRoster APIとの簡単な統合
  - 明確なAPIドキュメント
  - サンプルコードと統合ガイド
- **使用方法**: RosterHub APIクライアントの実装、統合テスト

**6. 学習プラットフォームベンダー**
- **役割**: 学習プラットフォーム（学習eポータル、LMSなど）の開発
- **目標**:
  - 名簿インポート用のOneRoster標準サポート
  - カスタム統合開発の削減
- **使用方法**: RosterHub APIの利用、OneRosterクライアントライブラリの実装

---

## 4. 教育ドメイン知識

### 4.1 日本の学校制度構造

#### 学年

**小学校**:
- 学年: 1年生から6年生（小1 〜 小6）
- 年齢: 6〜12歳
- 学年あたりのクラス数: 1〜8クラス（学校規模による）

**中学校**:
- 学年: 1年生から3年生（中1 〜 中3）
- 年齢: 12〜15歳
- 学年あたりのクラス数: 1〜10クラス

**高等学校**:
- 学年: 1年生から3年生（高1 〜 高3）
- 年齢: 15〜18歳
- 学年あたりのクラス数: 1〜12クラス

**大学**:
- 年次: 1年生から4年生（一般的）（1年 〜 4年）
- 年齢: 18〜22歳（学部）
- 構造: 学部、学科、コース

#### ホームルーム vs. 教科クラス

**ホームルーム**:
- 各生徒は1年間、1つのホームルームに所属
- 識別: 学年 + クラス番号（例: 3年2組 = 3年生、2組）
- 担任教師がクラス管理を担当
- 用途: 出席、学校行事、連絡

**教科クラス（授業クラス）**:
- 生徒は教科によって異なるクラスメートを持つ可能性
- 高校・大学でより一般的
- 選択科目により柔軟なクラス構成が生まれる

#### 出席番号

- 各生徒はホームルームクラス内で出席番号を持つ
- 一般的に日本語の五十音順（あいうえお順）で割り当てられる
- 用途: 点呼、座席配置、成績記録
- 範囲: 1〜約40（一般的なクラスサイズ）

### 4.2 日本の学校年度カレンダー

**学年度**: 4月〜3月（欧米諸国の9月〜6月ではない）

**学期**:
- **1学期**: 4月〜7月
- **2学期**: 9月〜12月
- **3学期**: 1月〜3月

**主要行事**:
- **4月**: 入学式、クラス割り当て発表
- **3月**: 卒業式、クラス替え
- **7月/12月**: 学期末試験、通知表
- **夏休み/冬休み/春休み**: 授業なし、ただし学年度は継続

**年度末名簿更新**（3月/4月）:
- 生徒は次の学年に進級
- ホームルームクラスが再編成される
- 教員が新しいクラス割り当てを受ける
- 卒業生が離れ、新入生が入る

### 4.3 日本の名前表記

日本の名前は複数の表記が必要:

**1. 漢字**: 公式な法的名前
- 姓 + 名（例: 山田 太郎）
- 保存先: `familyName` + `givenName`

**2. ひらがな**: 読み仮名
- アルファベット順ソート（日本語五十音順）に使用
- 保存先: `metadata.jp.familyNameKana` + `metadata.jp.givenNameKana`

**3. カタカナ**: 代替読み仮名
- 外国人名に使用されることがある
- 保存先: `metadata.jp.familyNameKatakana` + `metadata.jp.givenNameKatakana`

**4. ローマ字**: ラテンアルファベット（オプション）
- 例: YAMADA Taro
- 保存先: `username` または別フィールド

**名前の順序**: 日本語では姓が先（山田 太郎）だが、国際システムは名が先を期待することが多い（Taro Yamada）。RosterHubは両方の表記をサポート。

### 4.4 学校組織階層

**典型的な階層**:
```
都道府県
  └─ 市区町村
      └─ 学校
          └─ 学部 [大学のみ]
              └─ 学年
                  └─ 組/クラス
                      └─ 児童・生徒・学生
```

**OneRosterマッピング**:
- 都道府県 → Org（type: `state`）
- 市区町村 → Org（type: `local`）
- 学校 → Org（type: `school`）
- 学部 → Org（type: `department`）
- クラス → Class（type: `homeroom` または `scheduled`）
- 生徒 → User（role: `student`）

---

## 5. OneRoster標準概要

### 5.1 OneRosterとは？

**OneRoster**は、**1EdTech Consortium**（旧IMS Global Learning Consortium）が開発した、教育における**名簿データ交換**のための国際標準です。

**目的**: 学生情報システム（SIS）、学習管理システム（LMS）、その他の教育アプリケーション間の相互運用性を実現。

**現行バージョン**: OneRoster v1.2（2021年公開）

### 5.2 OneRosterコンポーネント

**1. データモデル**:
- **コアエンティティ**: Orgs、Academic Sessions、Courses、Classes、Users、Enrollments、Demographics
- **リレーションシップ**: ジャンクションテーブル経由の多対多関係
- **識別子**: `sourcedId`（一意識別子）、status（active/tobedeleted）

**2. REST API**:
- リアルタイムデータ交換用のRESTful API
- 標準エンドポイント: `/users`、`/orgs`、`/classes`、`/enrollments`など
- クエリパラメータ: フィルタリング、ページネーション、ソート、フィールド選択
- 認証: OAuth 2.0またはAPIキー

**3. CSV一括データ形式**:
- バッチデータインポート/エクスポート用のCSVファイル
- マニフェストファイルがすべてのCSVファイルをリスト
- 標準化されたカラム名
- 初期名簿インポートと定期的な一括更新に使用

### 5.3 Japan Profile拡張

**Japan Profile v1.2.2**は、日本固有の要件でOneRoster v1.2を拡張:

**1. メタデータ拡張**（`metadata.jp.*`）:
- かな名表記（ひらがな、カタカナ）
- 出席番号
- ホームルームクラス情報（学年・組）
- 日本の学年レベル（小1、中2、高3）

**2. 学年・クラス構造**:
- 日本の学年・クラスをOneRoster Classエンティティにマッピング
- ホームルームクラスタイプ（`type: homeroom`）
- 教科クラスタイプ（`type: scheduled`）

**3. 日本の学年度**:
- 学校年度: 4月〜3月
- 日本の学期と整合した学期セッション構造

**4. CSV形式の拡張**:
- 日本固有フィールド用の追加カラム
- CSVファイルのかなフィールドカラム
- 日本語文字エンコーディング（UTF-8 with BOM）

---

## 6. プロダクト機能

### 6.1 コア機能

**1. OneRoster v1.2 REST API（完全準拠）**
- すべての標準エンドポイント: `/users`、`/orgs`、`/classes`、`/courses`、`/enrollments`、`/academicSessions`、`/demographics`
- 標準クエリパラメータ: `limit`、`offset`、`orderBy`、`filter`、`fields`
- OneRosterフィルター構文パーサー
- ページネーションサポート（オフセットベース）
- 最適化されたレスポンスのためのフィールド選択

**2. Japan Profile 1.2.2 サポート**
- かな名フィールド（ひらがな、カタカナ）
- 出席番号サポート
- 日本の学年・クラス構造
- 日本の学年度カレンダー
- 日本固有データのメタデータ拡張

**3. CSVインポート/エクスポート**
- ストリーミングCSVパーサー（100MB以上のファイルを処理）
- 20万件以上のレコードをサポート
- 進捗追跡を伴うバックグラウンドジョブ処理
- 詳細なエラーレポートを伴うバリデーション
- 一括エクスポート用のCSV生成

**4. セキュリティとアクセス制御**
- bcryptハッシングによるAPIキー認証
- APIキーごとのIPホワイトリスト
- レート制限（スライディングウィンドウアルゴリズム）
- 包括的な監査ログ（すべてのCRUD操作）
- ロールベースアクセス制御（将来）

**5. データ同期**
- REST API経由のリアルタイム更新
- CSVインポート経由の一括同期
- 増分更新のためのDelta API（`dateLastModified`経由）
- 論理削除（ステータスベース）

### 6.2 統合シナリオ

**シナリオ1: 校務支援システムから学習ポータルへ**
1. 学校が校務支援システムで生徒名簿を更新
2. 校務支援システムがOneRoster CSVファイルをエクスポート
3. RosterHubがバックグラウンドジョブ経由でCSVファイルをインポート
4. 学習ポータルがRosterHub APIに更新された名簿を問い合わせ
5. 生徒が学習ポータルで正しいクラス割り当てを確認

**シナリオ2: リアルタイム生徒転入**
1. 生徒が新しい学校に転入
2. 校務支援システムがRosterHub APIを呼び出してユーザーを作成/更新
3. RosterHubが名簿データベースを即座に更新
4. すべての接続された学習ポータルがWebhook（将来）経由またはAPIポーリングで更新を受信
5. 学習ポータルで生徒アカウントがプロビジョニングされる

**シナリオ3: 年度末クラス替え**
1. 学校が次年度の新しいクラス割り当てを決定（クラス替え）
2. 校務支援システムが新しいクラスデータでOneRoster CSVを生成
3. RosterHubがバックグラウンドでCSVをインポート（2万人の生徒を5分で処理）
4. 学習ポータルが新学年開始前に更新された名簿を照会
5. 生徒が新しいクラスに自動登録される

---

## 7. 競争環境

### 7.1 現在のソリューション

**1. 手作業によるデータ入力**
- **現状**: 学校スタッフが各学習プラットフォームに手作業で名簿データを入力
- **課題**: 時間がかかる、エラーが発生しやすい、スケーラブルでない
- **RosterHubの優位性**: 自動化されたデータ交換により手作業入力を排除

**2. ベンダー固有の統合**
- **現状**: 各学習プラットフォームが独自のインポート形式を持つ
- **課題**: ベンダーロックイン、高い切り替えコスト、相互運用性なし
- **RosterHubの優位性**: オープン標準（OneRoster）によりベンダー中立的な統合を実現

**3. CSVファイル交換**
- **現状**: 学校が校務支援システムからCSVをエクスポートし、学習プラットフォームに手動でインポート
- **課題**: 手動ファイル転送、リアルタイム更新なし、形式の不一致
- **RosterHubの優位性**: 自動化されたCSVインポート/エクスポート + リアルタイムAPI

**4. カスタムAPI統合**
- **現状**: 一部の学校がカスタム統合スクリプトを開発
- **課題**: 高い開発コスト、保守負担、再利用不可
- **RosterHubの優位性**: 包括的なドキュメントを備えた標準API

### 7.2 差別化要因

**1. OneRoster国際標準準拠**
- グローバルな学習プラットフォームとの相互運用性を保証
- 将来性: 1EdTech Consortiumによって標準が積極的に維持されている
- ベンダー中立: 特定のベンダーへのロックインなし

**2. Japan Profileサポート**
- Japan Profile 1.2.2 拡張を完全にサポートする唯一のソリューション
- 日本の教育概念へのネイティブサポート
- 日本の教育者とベンダーの意見を取り入れて開発

**3. 高性能**
- 大規模データセット（20万人以上の生徒・教員）を処理
- 大規模ファイルのストリーミングCSV処理
- 一括操作のためのバックグラウンドジョブ処理
- 高速APIレスポンスのためのRedisキャッシング

**4. 包括的なセキュリティ**
- エンタープライズグレードの認証と認可
- コンプライアンスのための監査ログ（例: GDPR、日本の個人情報保護法）
- ネットワークレベルのセキュリティのためのIPホワイトリスト
- 悪用を防ぐレート制限

---

## 8. ビジネスモデル

### 8.1 対象デプロイモデル

**1. SaaS（Software as a Service）**
- RosterHubをクラウド（AWS、Google Cloud、Azure）でホスティング
- 学校がRosterHubサービスをサブスクリプション
- 価格設定: 生徒単位/学校単位の価格
- メリット: インフラ管理不要、自動更新

**2. オンプレミスインストール**
- 学校または自治体がデータセンターでRosterHubをホスト
- 簡単なセットアップのためのDockerベースのデプロイ
- ライセンス: 年間ライセンス料
- メリット: データ主権、完全な制御

**3. ハイブリッドクラウド**
- 市区町村/都道府県クラウドでRosterHubをホスト
- 複数の学校が1つのインスタンスを共有
- 価格設定: 組織単位のサブスクリプション
- メリット: コスト共有、ローカルデータレジデンシー

### 8.2 収益ストリーム（潜在的）

**1. サブスクリプション料金**
- 生徒単位価格設定（例: 生徒1人あたり年間¥10-50）
- 学校単位定額料金（例: 学校1校あたり年間¥100,000-500,000）
- 自治体単位の一括価格設定

**2. プロフェッショナルサービス**
- 統合コンサルティング
- カスタムAPI開発
- トレーニングとオンボーディング

**3. サポート契約**
- SLA付きプレミアムサポート
- 大規模デプロイ向け24/7サポート

---

## 9. 成功指標

### 9.1 プロダクト指標

**導入**:
- RosterHubを使用する学校数
- 管理される生徒・教員数
- 学校あたりの接続された学習プラットフォーム数

**使用状況**:
- APIリクエスト量（リクエスト/日）
- CSVインポートジョブ量（ジョブ/月）
- 平均名簿更新頻度

**パフォーマンス**:
- APIレスポンスタイム（95パーセンタイル < 200ms）
- CSVインポートスループット（20万レコードを30分以内に処理）
- システム稼働時間（99.9%可用性）

### 9.2 ビジネス指標

**時間節約**:
- 名簿データ入力で学校あたり節約された時間
- データ入力エラーの削減
- より速い生徒オンボーディング（転入生）

**ユーザー満足度**:
- 学校管理者からのネットプロモータースコア（NPS）
- サポートチケット量と解決時間
- 機能リクエスト充足率

**市場浸透**:
- RosterHubを使用する対象学校の割合
- 地理的カバレッジ（都道府県、市区町村）
- 学習プラットフォームベンダーの採用

---

## 10. 規制とコンプライアンス

### 10.1 個人情報保護法

**1. 個人情報保護法**
- 個人データの取り扱いに関する日本の個人情報保護法
- RosterHubは以下を確保する必要: 安全な保管、アクセス制御、監査ログ
- 生徒・教員データは保護が必要な個人情報

**2. GDPR（一般データ保護規則）**
- EU の学校がRosterHubを使用する場合（将来の拡張）
- 消去権（論理削除サポート）
- データポータビリティ（CSVエクスポート）
- 同意管理（将来の拡張）

### 10.2 教育データ標準

**1. 1EdTech Consortium標準**
- OneRoster v1.2 仕様準拠
- LTI（Learning Tools Interoperability）互換性（将来）

**2. 日本文部科学省標準**
- GIGAスクール構想との整合
- 学習eポータル標準モデル
- ICT CONNECT 21 ガイドライン

---

## 11. ロードマップと将来ビジョン

### 11.1 短期（6ヶ月）

**1. OneRoster v1.2 + Japan Profile 1.2.2 実装の完了**
- すべてのコアエンティティとエンドポイント
- 完全なCSVインポート/エクスポートサポート
- 本番レディのセキュリティとパフォーマンス

**2. リファレンス実装とドキュメント**
- 校務支援システム向け統合ガイド
- 学習プラットフォームベンダー向けサンプルコード
- Swagger/OpenAPIによるAPIドキュメント

**3. パイロット展開**
- 異なる都道府県の3〜5校
- 2〜3の学習プラットフォーム統合
- フィードバック収集と反復

### 11.2 中期（12ヶ月）

**1. LTI統合**
- シームレスな学習ツール統合のためのLTI Advantageサポート
- 学校アイデンティティプロバイダーとのシングルサインオン（SSO）

**2. リアルタイムイベント通知**
- 名簿変更通知のためのWebhookサポート
- リアルタイム更新のためのWebSocketサポート

**3. マルチテナンシー**
- 単一インスタンスでの複数学校/組織のサポート
- データ分離とアクセス制御

**4. 高度な分析**
- 名簿データ品質ダッシュボード
- 同期ステータス監視
- 学校向け使用状況分析

### 11.3 長期（2年以上）

**1. 国際展開**
- 他のアジア諸国のサポート（韓国、台湾、シンガポール）
- 多言語サポート
- 国別プロファイル拡張

**2. 学習分析統合**
- Caliper Analyticsサポート
- 学習データウェアハウス統合
- クロスプラットフォーム学習分析

**3. AI駆動機能**
- 自動クラス割り当て最適化
- 名簿データの異常検出
- 予測的履修登録管理

---

## まとめ

RosterHubは、以下を実現する**教育名簿データ交換のための統合ハブ**です:

**重要な課題を解決**:
- 日本の学校における手作業による名簿データ入力の負担を排除
- 国際OneRoster標準を使用した名簿データ交換を標準化
- Japan Profileを通じて日本の教育システム固有の要件をサポート

**特定のユーザーを対象**:
- 学校IT管理者（主要ユーザー）
- 校務担当教員（間接ユーザー）
- システムインテグレーターと学習プラットフォームベンダー（技術ユーザー）

**主要な価値を提供**:
- 時間節約: 学校あたり年間20〜40時間
- データ正確性: 重複データ入力エラーを排除
- 相互運用性: ベンダー中立の標準によりプラットフォーム切り替えが可能

**強固な基盤の上に構築**:
- OneRoster v1.2 国際標準（1EdTech Consortium）
- Japan Profile 1.2.2（1EdTech Japan、ICT CONNECT 21）
- モダン技術スタック（NestJS、PostgreSQL、Prisma、Docker）

**日本の教育ドメインに対応**:
- ホームルーム vs. 教科クラスの区別
- 日本の学年度（4月〜3月）
- かな名表記
- 学年・組構造
- 出席番号

RosterHubは、校務支援システムと学習プラットフォーム間のシームレスな統合を可能にし、日本の教育機関における**標準的な名簿データハブ**になることを目指しています。
